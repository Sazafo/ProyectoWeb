<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventario - Tienda Ropa</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .navbar { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/vendedor/panel">Panel Vendedor</a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/productos/publicar">Publicar Producto</a>
                <a class="nav-link active" href="/vendedor/inventario">Inventario</a>
                <form th:action="@{/logout}" method="post" class="d-inline">
                    <button type="submit" class="btn btn-link nav-link">Salir</button>
                </form>
            </div>
        </div>
    </nav>

    <!-- HU-015: Inventario de productos -->
    <div class="container mt-5">
        <h2 class="mb-4">Inventario de Productos</h2>
        
        <div th:if="${mensaje}" class="alert alert-success" th:text="${mensaje}"></div>
        <div th:if="${alerta}" class="alert alert-warning" th:text="${alerta}"></div>
        <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

        <div th:if="${#lists.isEmpty(productos)}" class="alert alert-info text-center">
            <h4>No tienes productos en tu inventario</h4>
            <a href="/productos/publicar" class="btn btn-primary">Publicar Mi Primer Producto</a>
        </div>

        <div class="table-responsive" th:unless="${#lists.isEmpty(productos)}">
            <table class="table table-hover table-bordered">
                <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th>Imagen</th>
                        <th>Producto</th>
                        <th>Categoría</th>
                        <th>Precio</th>
                        <th>Stock</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="prod : ${productos}">
                        <td th:text="${prod.idProducto}">1</td>
                        <td>
                            <img th:src="@{'/img/productos/' + ${prod.imagen}}" 
                                 th:alt="${prod.nombre}" 
                                 style="width: 50px; height: 50px; object-fit: cover;"
                                 onerror="this.src='https://via.placeholder.com/50'">
                        </td>
                        <td>
                            <strong th:text="${prod.nombre}">Producto</strong><br>
                            <small class="text-muted" th:text="${prod.descripcion}">Descripción</small>
                        </td>
                        <td><span class="badge bg-secondary" th:text="${prod.categoria}">Cat</span></td>
                        <td class="text-nowrap">₡ <span th:text="${prod.precio}">0.00</span></td>
                        <td>
                            <span th:text="${prod.stock}">0</span>
                            <span class="badge bg-warning" th:if="${prod.stock < 5 && prod.stock > 0}">
                                Stock Bajo
                            </span>
                            <span class="badge bg-danger" th:if="${prod.stock == 0}">
                                Agotado
                            </span>
                        </td>
                        <td>
                            <span class="badge" 
                                  th:classappend="${prod.estado.name() == 'PENDIENTE'} ? 'bg-warning' : 
                                                 (${prod.estado.name() == 'APROBADO'} ? 'bg-success' : 'bg-secondary')"
                                  th:text="${prod.estado}">
                                Estado
                            </span>
                        </td>
                        <td>
                            <div class="btn-group" role="group">
                                <a th:href="@{'/vendedor/productos/' + ${prod.idProducto} + '/editar'}" 
                                   class="btn btn-sm btn-outline-primary" title="Editar">
                                    Editar
                                </a>
                                <form th:action="@{'/vendedor/productos/' + ${prod.idProducto} + '/eliminar'}" 
                                      method="post" 
                                      onsubmit="return confirm('¿Eliminar este producto?');"
                                      style="display: inline;">
                                    <button type="submit" class="btn btn-sm btn-outline-danger" title="Eliminar">
                                        Eliminar
                                    </button>
                                </form>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="mt-3">
            <a href="/vendedor/panel" class="btn btn-outline-secondary">Volver al Panel</a>
            <a href="/productos/publicar" class="btn btn-primary">Publicar Nuevo Producto</a>
        </div>
    </div>
</body>
</html>